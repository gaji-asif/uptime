$(document).ready(function(){$('.get-employee-from-build').change(function(e){e.preventDefault();var value=$(this).val();var form=$(this).closest('form');if(value==0){form.find('.employee-list').addClass('hide');form.find('button').addClass('hide');}else{$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/master/validations/get-employee/"+value,type:'POST',dataType:'json',success:function(result){if(result.status){var select_html='';if(result.data.length!=0){select_html='<option value="">Select Employee</option>';$.each(result.data,function(index,value){select_html+='<option value="'+value.id+'">'+value.full_name+'</option>';});form.find('.employee-list').find('select').html(select_html);}else{form.find('.employee-list').find('select').addClass('hide');form.find('button').addClass('hide');form.find('.employee-list').find('label').html('No employee found.');}
form.find('button').removeClass('hide');form.find('.employee-list').removeClass('hide');}else{form.find('.employee-list').find('select').addClass('hide');form.find('.employee-list').find('label').html('No employee found.');form.find('button').addClass('hide');}}});}});$('.get-employee-from-build_emp').change(function(e){e.preventDefault();var value=$(this).val();var form=$(this).closest('form');if(value==0){form.find('.employee-list').addClass('hide');form.find('button').addClass('hide');}else{$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/master/employee/validations/get-employee/"+value,type:'POST',dataType:'json',success:function(result){if(result.status){var select_html='';if(result.data.length!=0){select_html='<option value="">Select Employee</option>';$.each(result.data,function(index,value){select_html+='<option value="'+value.id+'">'+value.full_name+'</option>';});form.find('.employee-list').find('select').html(select_html);}else{form.find('.employee-list').find('select').addClass('hide');form.find('button').addClass('hide');form.find('.employee-list').find('label').html('No employee found.');}
form.find('button').removeClass('hide');form.find('.employee-list').removeClass('hide');}else{form.find('.employee-list').find('select').addClass('hide');form.find('.employee-list').find('label').html('No employee found.');form.find('button').addClass('hide');}}});}});$(document).on('click','.trash-button',function(e){e.preventDefault();var _this=$(this);var _attname=_this.attr('data-att-name')
var _url=_this.attr('href');var _txt="";console.log(_attname);if(_attname=="employee"){_txt='This action can not be undone!'}else if(_attname=="challenge"){_txt='Challenge will be remove!'}else if(_attname=="user"){_txt='You will not be able to see this user details!';}else if(_attname=="category"){_txt='You will not be able to see this category!';}else if(_attname=="build"){_txt='You will not be able to see this build!';}else if(_attname=="validation"){_txt='You will not be able to see this Validation!';}else if(_attname=="employee1"||_attname=="challenge1"){_txt='This action must be approved by an admin';}else if(_attname=="Echallenge"){_txt='This action can not be undone!';}
swal({title:"Are you sure?",text:_txt,type:"warning",showCancelButton:true,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel please!",closeOnConfirm:false,closeOnCancel:false,showLoaderOnConfirm:true},function(isConfirm){if(isConfirm){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:_url,type:'get',dataType:'json',success:function(resp){if(resp.status==true){swal("Deleted!",resp.message,"success");_this.closest('tr').remove();var table=$('#order-listing').DataTable();table.ajax.reload(function(json){$('#myInput').val(json.lastInput);});}else{swal("Oops!",resp.message,"error");}}});}else{swal.close();}});});$('#removeImage').click(function(e){e.preventDefault();var form=$(this).closest('form');form.find('#delete_image').val(1);$(this).closest('.form-group-image').remove();});$(document).on('submit','#Change-pass-form',function(e){e.preventDefault();var form=$(this);var data=$(this).serialize();$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/users/change-password",type:'POST',dataType:'json',data:data,success:function(result){form.find('.change-pass-alert').slideUp();if(result.status){swal({title:"Success",text:result.message,type:"success"},function(){location.reload();});setTimeout(function(){location.reload();},5000);}else{form.find('.change-pass-alert ul').empty().append(result.message);form.find('.change-pass-alert').slideDown();form[0].reset();}}});});$(document).on('click','#check-pass',function(e){e.preventDefault();var form=$(this).closest('form');if($(this).find('i').hasClass('fa-eye-slash')){$(this).find('i').removeClass('fa-eye-slash');$(this).find('i').addClass('fa-eye');form.find('#password').attr('type','text');}else{$(this).find('i').addClass('fa-eye-slash');$(this).find('i').removeClass('fa-eye');form.find('#password').attr('type','password');}});$(document).on('click','.empChangePass',function(e){e.preventDefault();var pass_module=$(this).attr('data-target');var id=$(this).attr('data-id');var uniqe_id=Math.random().toString(36).substr(2,12);$(pass_module).find('form').attr('data-id',id);$(pass_module).find('form').find('#password').val(uniqe_id);});$(document).on('click','#empChangePassBtn',function(e){e.preventDefault();var form=$('form#empChangePassForm');var id=form.attr('data-id');var data=form.serialize();$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/employee/change-password/"+id,type:'POST',dataType:'json',data:data,success:function(result){form.find('.change-pass-alert').slideUp();if(result.status){swal({title:"Success",text:result.message,type:"success"},function(){location.reload();});setTimeout(function(){location.reload();},5000);}else{form.find('.change-pass-alert ul').empty().append(result.message);form.find('.change-pass-alert').slideDown();form[0].reset();}}});});$(document).on('change','.change-role-company',function(e){e.preventDefault();var role=$(this).val();var form=$(this).closest('form');form.find('#company_name').closest('div').removeClass('hide').addClass('hide');form.find('#first_name').closest('div').removeClass('hide').addClass('hide');form.find('#last_name').closest('div').removeClass('hide').addClass('hide');form.find('#accesscode').closest('div').removeClass('hide').addClass('hide');form.find('#company_name').prop('required',false);form.find('#first_name').prop('required',false);form.find('#last_name').prop('required',false);if(role=='admin'){form.find('#first_name').closest('div').removeClass('hide');form.find('#last_name').closest('div').removeClass('hide');form.find('#first_name').prop('required',true);form.find('#last_name').prop('required',true);}else if(role=='company'){form.find('#company_name').closest('div').removeClass('hide');form.find('#company_name').prop('required',true);form.find('#accesscode').closest('div').removeClass('hide');form.find('#accesscode').prop('required',true);}});$('.emp-company-select').change(function(e){e.preventDefault();var form=$(this).closest('form');var id=$(this).val();form.find('#industry').closest('div').removeClass('hide').addClass('hide');form.find('#industry').html('<option value="0">select Industry</option>');if(id!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/master/employee/get-industry-from-company/"+id,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#industry').html(result.html);form.find('#industry').closest('div').removeClass('hide');}
else{swal("Oops!","No Industry","error");}}});}});$('.chall-company-select').change(function(e){e.preventDefault();var form=$(this).closest('form');var id=$(this).val();form.find('#category').closest('div').removeClass('hide').addClass('hide');form.find('#category').html('<option value="">Select Category</option>');if(id!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/master/challenge/get-cateory/"+id,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#category').html(result.html);form.find('#category').closest('div').removeClass('hide');}
else{swal("Oops!","No Category","error");}}});}});$('.level-chall-company-select').change(function(e){e.preventDefault();var form=$(this).closest('form');var id=$(this).val();form.find('#category').closest('div').removeClass('hide').addClass('hide');form.find('#category').html('<option value="">select Category</option>');if(id!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/employee/level-preset-challenge/get-cateory/"+id,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#category').html(result.html);form.find('#category').closest('div').removeClass('hide');}}});}});$('.empoyee-new-build').change(function(e){e.preventDefault();var form=$(this).closest('form');var id=$(this).val();form.find('#category_id').prop('disabled',true);form.find('#category_id').html('<option value="">selecte emplyee for category list</option>');form.find('#challenge_id').prop('disabled',true);form.find('#challenge_id').html('<option value="0">selecte category for challenge list</option>');if(id!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/master/builds/get-category-from-employee/"+id,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#category_id').html(result.category_html);form.find('#category_id').prop('disabled',false);}else{swal("Oops!",result.message,"error");}}});}});$('.build-category-add').change(function(e){e.preventDefault();var form=$(this).closest('form');var cat_id=$(this).val();var build_id=$(this).attr('data-id');var emp_id=form.find('.empoyee-new-build').val();form.find('#challenge_id').prop('disabled',true);form.find('#challenge_id').html('<option value="0">selecte emplyee for challenge list</option>');if(cat_id!=''&&emp_id!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/master/builds/get-challenge-from-category-and-employee/"+build_id+"/"+emp_id+"/"+cat_id,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#challenge_id').html(result.challenge_html);form.find('#challenge_id').prop('disabled',false);}else{swal("Oops!",result.message,"error");}}});}});$('.buil-category-add_emp').change(function(e){e.preventDefault();var form=$(this).closest('form');var cat_id=$(this).val();var build_id=$(this).attr('data-id');var emp_id=form.find('.empoyee-new-build').val();form.find('#challenge_id').prop('disabled',true);form.find('#challenge_id').html('<option value="0">selecte emplyee for challenge list</option>');if(cat_id!=''&&emp_id!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/employeebuilds/get-challenge-from-category-and-employee/"+build_id+"/"+emp_id+"/"+cat_id,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#challenge_id').html(result.challenge_html);form.find('#challenge_id').prop('disabled',false);}else{swal("Oops!",result.message,"error");}}});}});$('.change-notification-role').change(function(e){e.preventDefault();var form=$(this).closest('form');var key=$(this).val();form.find('#notification-list').removeClass('hide').addClass('hide');form.find('#notification-list').html('');if(key!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/master/users/get-notification-users/"+key,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#notification-list').removeClass('hide');form.find('#notification-list').html(result.html);$('.region').change(function(e){e.preventDefault();var form=$(this).closest('form');var key=$(this).val();form.find('#employee-notification-list').removeClass('hide').addClass('hide');form.find('#employee-notification-list').html('');if(key!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/master/users/get-notification-employee/"+key,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#employee-notification-list').removeClass('hide');form.find('#employee-notification-list').html(result.html);}
else{swal("Oops!",result.message,"error");}}});}});}else{swal("Oops!",result.message,"error");}}});}});$('.change-notification-role1').change(function(e){e.preventDefault();var form=$(this).closest('form');var key=$(this).val();form.find('#notification-list').removeClass('hide').addClass('hide');form.find('#notification-list').html('');if(key!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/executive/users/get-notification-users/"+key,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#notification-list').removeClass('hide');form.find('#notification-list').html(result.html);$('.region').change(function(e){e.preventDefault();var form=$(this).closest('form');var key=$(this).val();form.find('#employee-notification-list').removeClass('hide').addClass('hide');form.find('#employee-notification-list').html('');if(key!=''){$.ajax({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')},url:base_url+"/executive/users/get-notification-employee/"+key,type:'POST',dataType:'json',success:function(result){if(result.status){form.find('#employee-notification-list').removeClass('hide');form.find('#employee-notification-list').html(result.html);}
else{swal("Oops!",result.message,"error");}}});}});}else{swal("Oops!",result.message,"error");}}});}});});function multilpleCheckbox(table){$('#example-select-all').on('click',function(){var rows=table.rows({'search':'applied'}).nodes();$('input[type="checkbox"]',rows).prop('checked',this.checked);});$('#order-listing tbody').on('change','input[type="checkbox"]',function(){if(!this.checked){var el=$('#example-select-all').get(0);if(el&&el.checked&&('indeterminate'in el)){el.indeterminate=true;}}});}